{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/abdulaliyev/tut/nextjs-graphql/online-store/frontend/components/CreateItem.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation CREATE_ITEM_MUTATION(\\n    $title: String!\\n    $description: String!\\n    $price: Int!\\n    $image: String\\n    $largeImage: String\\n  ) {\\n    createItem(\\n      title: $title\\n      description: $description\\n      price: $price\\n      image: $image\\n      largeImage: $largeImage\\n    ) {\\n      id\\n      title\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport Router from 'next/router';\nimport Form from './styles/Form';\nimport formatMoney from '../lib/formatMoney';\nimport Error from './ErrorMessage';\nexport var CREATE_ITEM_MUTATION = gql(_templateObject());\n\nvar CreateItem = function CreateItem() {\n  var _useState = useState('Item Title'),\n      _useState2 = _slicedToArray(_useState, 2),\n      title = _useState2[0],\n      setTitle = _useState2[1];\n\n  var _useState3 = useState('Item Description'),\n      _useState4 = _slicedToArray(_useState3, 2),\n      description = _useState4[0],\n      setDescription = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      image = _useState6[0],\n      setImage = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      largeImage = _useState8[0],\n      setLargeImage = _useState8[1];\n\n  var _useState9 = useState(9998),\n      _useState10 = _slicedToArray(_useState9, 2),\n      price = _useState10[0],\n      setPrice = _useState10[1];\n\n  var uploadFile =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var files, data, res, file;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              files = e.target.files;\n              data = new FormData();\n              data.append('file', files[0]);\n              data.append('upload_preset', 'greatfits'); // https://res.cloudinary.com/greatfits/image/upload/v1564874789/sample.jpg\n\n              _context.next = 6;\n              return fetch(\"https://api.cloudinary.com/v1_1/greatfits/image/upload\", {\n                method: 'POST',\n                body: data\n              });\n\n            case 6:\n              res = _context.sent;\n              _context.next = 9;\n              return res.json();\n\n            case 9:\n              file = _context.sent;\n              setImage(file.secure_url);\n              setLargeImage(file.eager[0].secure_url);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function uploadFile(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Mutation, {\n    mutation: CREATE_ITEM_MUTATION,\n    variables: {\n      title: title,\n      description: description,\n      image: image,\n      largeImage: largeImage,\n      price: price\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, function (createItem, _ref2) {\n    var loading = _ref2.loading,\n        error = _ref2.error;\n    return React.createElement(Form, {\n      onSubmit:\n      /*#__PURE__*/\n      function () {\n        var _ref3 = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee2(e) {\n          var res;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  // Stop the form from submitting\n                  e.preventDefault(); // Call the mutation\n\n                  _context2.next = 3;\n                  return createItem();\n\n                case 3:\n                  res = _context2.sent;\n                  // Change them to the single item page\n                  Router.push({\n                    pathname: '/item',\n                    query: {\n                      id: res.data.createItem.id\n                    }\n                  });\n\n                case 5:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function (_x2) {\n          return _ref3.apply(this, arguments);\n        };\n      }(),\n      method: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, React.createElement(Error, {\n      error: error,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }), React.createElement(\"fieldset\", {\n      disabled: loading,\n      \"aria-busy\": loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"file\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, \"Image\", React.createElement(\"input\", {\n      type: \"file\",\n      id: \"file\",\n      name: \"file\",\n      placeholder: \"Upload an image\",\n      required: true,\n      onChange: uploadFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }), image && React.createElement(\"img\", {\n      src: image,\n      alt: \"Upload Preview\",\n      width: \"200\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      htmlFor: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, \"Title\", React.createElement(\"input\", {\n      type: \"text\",\n      id: \"title\",\n      name: \"title\",\n      placeholder: \"Title\",\n      required: true,\n      value: title,\n      onChange: function onChange(e) {\n        return setTitle(e.target.value);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      htmlFor: \"price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Price\", React.createElement(\"input\", {\n      type: \"number\",\n      id: \"price\",\n      name: \"price\",\n      placeholder: \"Price\",\n      required: true,\n      value: price,\n      onChange: function onChange(e) {\n        return setPrice(e.target.value);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      htmlFor: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, \"Description\", React.createElement(\"textarea\", {\n      id: \"description\",\n      name: \"description\",\n      placeholder: \"Enter a Description\",\n      required: true,\n      value: description,\n      onChange: function onChange(e) {\n        return setDescription(e.target.value);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"Submit\")));\n  });\n};\n\nexport default CreateItem;","map":{"version":3,"sources":["/Users/abdulaliyev/tut/nextjs-graphql/online-store/frontend/components/CreateItem.js"],"names":["React","useState","Mutation","gql","Router","Form","formatMoney","Error","CREATE_ITEM_MUTATION","CreateItem","title","setTitle","description","setDescription","image","setImage","largeImage","setLargeImage","price","setPrice","uploadFile","e","files","target","data","FormData","append","fetch","method","body","res","json","file","secure_url","eager","createItem","loading","error","preventDefault","push","pathname","query","id","value"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport Router from 'next/router';\nimport Form from './styles/Form';\nimport formatMoney from '../lib/formatMoney';\nimport Error from './ErrorMessage';\n\nexport const CREATE_ITEM_MUTATION = gql`\n  mutation CREATE_ITEM_MUTATION(\n    $title: String!\n    $description: String!\n    $price: Int!\n    $image: String\n    $largeImage: String\n  ) {\n    createItem(\n      title: $title\n      description: $description\n      price: $price\n      image: $image\n      largeImage: $largeImage\n    ) {\n      id\n      title\n    }\n  }\n`;\n\nconst CreateItem = () => {\n  const [title, setTitle] = useState('Item Title');\n  const [description, setDescription] = useState('Item Description');\n  const [image, setImage] = useState('');\n  const [largeImage, setLargeImage] = useState('');\n  const [price, setPrice] = useState(9998);\n\n  const uploadFile = async e => {\n    const files = e.target.files;\n    const data = new FormData();\n    data.append('file', files[0]);\n    data.append('upload_preset', 'greatfits');\n    // https://res.cloudinary.com/greatfits/image/upload/v1564874789/sample.jpg\n    const res = await fetch(`https://api.cloudinary.com/v1_1/greatfits/image/upload`, {\n      method: 'POST',\n      body: data\n    });\n    const file = await res.json();\n    setImage(file.secure_url);\n    setLargeImage(file.eager[0].secure_url);\n  }\n\n  return (\n    <Mutation\n      mutation={CREATE_ITEM_MUTATION}\n      variables={{\n        title,\n        description,\n        image,\n        largeImage,\n        price\n      }}\n    >\n      {(createItem, { loading, error }) => (\n        <Form\n          onSubmit={ async e => {\n            // Stop the form from submitting\n            e.preventDefault();\n            // Call the mutation\n            const res = await createItem();\n            // Change them to the single item page\n            Router.push({\n                pathname: '/item',\n                query: { id: res.data.createItem.id }\n            });\n          }}\n          method=\"post\"\n        >\n        <Error error={error}/>\n          <fieldset disabled={loading} aria-busy={loading}>\n            <label htmlFor=\"file\">\n              Image\n              <input\n                type=\"file\"\n                id=\"file\"\n                name=\"file\"\n                placeholder=\"Upload an image\"\n                required\n                onChange={uploadFile}\n              />\n              {image && <img src={image} alt=\"Upload Preview\" width=\"200\"/>}\n            </label>\n            <label htmlFor=\"title\">\n              Title\n              <input\n                type=\"text\"\n                id=\"title\"\n                name=\"title\"\n                placeholder=\"Title\"\n                required\n                value={title}\n                onChange={e => setTitle(e.target.value)}\n              />\n            </label>\n            <label htmlFor=\"price\">\n              Price\n              <input\n                type=\"number\"\n                id=\"price\"\n                name=\"price\"\n                placeholder=\"Price\"\n                required\n                value={price}\n                onChange={e => setPrice(e.target.value)}\n              />\n            </label>\n            <label htmlFor=\"title\">\n              Description\n              <textarea\n                id=\"description\"\n                name=\"description\"\n                placeholder=\"Enter a Description\"\n                required\n                value={description}\n                onChange={e => setDescription(e.target.value)}\n              />\n            </label>\n            <button type=\"submit\">Submit</button>\n          </fieldset>\n        </Form>\n      )}\n    </Mutation>\n  );\n};\n\nexport default CreateItem;\n"]},"metadata":{},"sourceType":"module"}