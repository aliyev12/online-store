{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    users {\\n      id\\n      name\\n      email\\n      permissions\\n    }\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation updatePermissions($permissions: [Permission], $userId: ID!) {\\n    updatePermissions(permissions: $permissions, userId: $userId) {\\n      id\\n      permissions\\n      name\\n      email\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport { useQuery, useMutation } from '@apollo/react-hooks';\nimport { gql } from 'apollo-boost';\nimport Error from './ErrorMessage';\nimport Table from './styles/Table';\nimport SickButton from './styles/SickButton';\nvar possiblePermissions = ['ADMIN', 'USER', 'ITEMCREATE', 'ITEMUPDATE', 'ITEMDELETE', 'PERMISSIONUPDATE'];\nvar UPDATE_PERMISSIONS_MUTATION = gql(_templateObject());\nvar ALL_USERS_QUERY = gql(_templateObject2());\n\nvar Permissions = function Permissions(props) {\n  var _useQuery = useQuery(ALL_USERS_QUERY),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error;\n\n  return console.log(data && data) || React.createElement(React.Fragment, null, React.createElement(Error, {\n    error: error\n  }), React.createElement(\"div\", null, React.createElement(\"h2\", null, \"Manage Permissions\"), React.createElement(Table, null, React.createElement(\"thead\", null, React.createElement(\"tr\", null, React.createElement(\"th\", null, \"Name\"), React.createElement(\"th\", null, \"Email\"), possiblePermissions.map(function (permission) {\n    return React.createElement(\"th\", {\n      key: permission\n    }, permission);\n  }), React.createElement(\"th\", null, React.createElement(\"span\", {\n    role: \"image\"\n  }, \"\\uD83D\\uDC47\")))), React.createElement(\"tbody\", null, data && data.users && data.users.map(function (user) {\n    return React.createElement(UserPermissions, {\n      key: user.id,\n      user: user\n    });\n  })))));\n};\n\nvar UserPermissions = function UserPermissions(_ref) {\n  var user = _ref.user;\n\n  var _useState = useState(user.permissions),\n      _useState2 = _slicedToArray(_useState, 2),\n      permissions = _useState2[0],\n      setPermissions = _useState2[1];\n\n  var handlePermissionChange = function handlePermissionChange(e, updatePermissions) {\n    var checkbox = e.target; // Tale a copy of the current permissions\n\n    var updatedPermissions = _toConsumableArray(permissions); // Figure out if you need to add or remove a permission\n\n\n    if (checkbox.checked) {\n      // Add it in\n      updatedPermissions.push(checkbox.value);\n    } else {\n      updatedPermissions = updatedPermissions.filter(function (permission) {\n        return permission !== checkbox.value;\n      });\n    }\n\n    var setState =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return setPermissions(updatedPermissions);\n\n              case 2:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function setState() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    setState().then(function () {\n      return updatePermissions();\n    });\n  };\n\n  var _useMutation = useMutation(UPDATE_PERMISSIONS_MUTATION, {\n    variables: {\n      permissions: permissions,\n      userId: user.id\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updatePermissions = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      loading = _useMutation2$.loading,\n      error = _useMutation2$.error;\n\n  return React.createElement(React.Fragment, null, error && React.createElement(\"tr\", null, React.createElement(\"td\", {\n    colSpan: \"8\"\n  }, React.createElement(Error, {\n    error: error\n  }))), React.createElement(\"tr\", null, React.createElement(\"td\", null, user.name), React.createElement(\"td\", null, user.email), possiblePermissions.map(function (permission, i) {\n    return React.createElement(\"td\", {\n      key: permission + i\n    }, React.createElement(\"label\", {\n      htmlFor: \"\".concat(user.id, \"-permission-\").concat(permission)\n    }, React.createElement(\"input\", {\n      id: \"\".concat(user.id, \"-permission-\").concat(permission),\n      type: \"checkbox\",\n      checked: permissions.includes(permission),\n      value: permission,\n      onChange: function onChange(e) {\n        return handlePermissionChange(e, updatePermissions);\n      }\n    })));\n  }), React.createElement(\"td\", null, React.createElement(SickButton, {\n    type: \"button\",\n    disabled: loading,\n    onClick: updatePermissions\n  }, \"Updat\", loading ? 'ing' : 'e'))));\n};\n\nexport default Permissions; // import React, { useState } from 'react';\n// import { Query, Mutation } from 'react-apollo';\n// import gql from 'graphql-tag';\n// import PropTypes from 'prop-types';\n// import Error from './ErrorMessage';\n// import Table from './styles/Table';\n// import SickButton from './styles/SickButton';\n// const possiblePermissions = [\n//   'ADMIN',\n//   'USER',\n//   'ITEMCREATE',\n//   'ITEMUPDATE',\n//   'ITEMDELETE',\n//   'PERMISSIONUPDATE'\n// ];\n// const UPDATE_PERMISSIONS_MUTATION = gql`\n//   mutation updatePermissions($permissions: [Permission], $userId: ID!) {\n//     updatePermissions(permissions: $permissions, userId: $userId) {\n//       id\n//       permissions\n//       name\n//       email\n//     }\n//   }\n// `;\n// const ALL_USERS_QUERY = gql`\n//   query {\n//     users {\n//       id\n//       name\n//       email\n//       permissions\n//     }\n//   }\n// `;\n// const Permissions = props => (\n//   <Query query={ALL_USERS_QUERY}>\n//     {({ data, loading, error }) =>\n//       console.log(data) || (\n//         <>\n//           <Error error={error} />\n//           <div>\n//             <h2>Manage Permissions</h2>\n//             <Table>\n//               <thead>\n//                 <tr>\n//                   <th>Name</th>\n//                   <th>Email</th>\n//                   {possiblePermissions.map(permission => (\n//                     <th key={permission}>{permission}</th>\n//                   ))}\n//                   <th>\n//                     <span role=\"image\">ðŸ‘‡</span>\n//                   </th>\n//                 </tr>\n//               </thead>\n//               <tbody>\n//                 {data.users.map(user => (\n//                   <UserPermissions key={user.id} user={user} />\n//                 ))}\n//               </tbody>\n//             </Table>\n//           </div>\n//         </>\n//       )\n//     }\n//   </Query>\n// );\n// const UserPermissions = ({ user }) => {\n//   const [permissions, setPermissions] = useState(user.permissions);\n//   const handlePermissionChange = (e, updatePermissions) => {\n//     const checkbox = e.target;\n//     // Tale a copy of the current permissions\n//     let updatedPermissions = [...permissions];\n//     // Figure out if you need to add or remove a permission\n//     if (checkbox.checked) {\n//       // Add it in\n//       updatedPermissions.push(checkbox.value);\n//     } else {\n//       updatedPermissions = updatedPermissions.filter(\n//         permission => permission !== checkbox.value\n//       );\n//     }\n//     const setState = async () => await setPermissions(updatedPermissions);\n//     setState().then(() => updatePermissions());\n//     };\n//   return (\n//     <Mutation\n//       mutation={UPDATE_PERMISSIONS_MUTATION}\n//       variables={{\n//         permissions,\n//         userId: user.id\n//       }}\n//     >\n//       {(updatePermissions, { loading, error }) => (\n//         <>\n//           {error && (\n//             <tr>\n//               <td colSpan=\"8\">\n//                 <Error error={error} />\n//               </td>\n//             </tr>\n//           )}\n//           <tr>\n//             <td>{user.name}</td>\n//             <td>{user.email}</td>\n//             {possiblePermissions.map((permission, i) => (\n//               <td key={permission + i}>\n//                 <label htmlFor={`${user.id}-permission-${permission}`}>\n//                   <input\n//                     id={`${user.id}-permission-${permission}`}\n//                     type=\"checkbox\"\n//                     checked={permissions.includes(permission)}\n//                     value={permission}\n//                     onChange={e => handlePermissionChange(e, updatePermissions)}\n//                   />\n//                 </label>\n//               </td>\n//             ))}\n//             <td>\n//               <SickButton\n//                 type=\"button\"\n//                 disabled={loading}\n//                 onClick={updatePermissions}\n//               >\n//                 Updat{loading ? 'ing' : 'e'}\n//               </SickButton>\n//             </td>\n//           </tr>\n//         </>\n//       )}\n//     </Mutation>\n//   );\n// };\n// UserPermissions.propTypes = {\n//   user: PropTypes.shape({\n//     name: PropTypes.string,\n//     email: PropTypes.string,\n//     id: PropTypes.string,\n//     permissions: PropTypes.array\n//   }).isRequired\n// };\n// export default Permissions;","map":null,"metadata":{},"sourceType":"module"}